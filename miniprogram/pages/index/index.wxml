<view class="container">
  <view class="header">
    <text class="title">æ¼”è®²ç¨¿ç”Ÿæˆå™¨</text>
    <view class="settings-icon" bindtap="showSettings">âš™ï¸</view>
    <view class="debug-toggle" bindtap="toggleDebugMode">ğŸ”§</view>
  </view>
  
  <view class="input-section">
    <text class="label">è¯·è¾“å…¥æºæ–‡æœ¬ï¼š</text>
    <textarea class="input-area" placeholder="åœ¨æ­¤è¾“å…¥éœ€è¦è½¬æ¢çš„æ–‡æœ¬å†…å®¹..." bindinput="onInputChange" value="{{sourceText}}"></textarea>
  </view>

  <view class="button-section">
    <button class="generate-btn" bindtap="generateSpeech" data-language="ä¸­æ–‡">ç”Ÿæˆä¸­æ–‡æ¼”è®²ç¨¿</button>
    <button class="generate-btn" bindtap="generateSpeech" data-language="è‹±æ–‡">ç”Ÿæˆè‹±æ–‡æ¼”è®²ç¨¿</button>
  </view>

  <view class="output-section" wx:if="{{speech}}">
    <text class="label">ç”Ÿæˆçš„æ¼”è®²ç¨¿ï¼š</text>
    <view class="speech-content">
      <text>{{speech}}</text>
    </view>

    <view class="button-section">
      <button class="generate-btn" bindtap="transcribeAudio" disabled="{{isTranscribing}}">
        {{isTranscribing ? 'è½¬æ¢ä¸­...' : 'è¯­éŸ³è½¬æ–‡æœ¬'}}
      </button>
    </view>

    <view class="output-section" wx:if="{{transcribedText}}">
      <text class="label">è¯†åˆ«ç»“æœï¼š</text>
      <view class="speech-content">
        <text>{{transcribedText}}</text>
      </view>
    </view>

    <view class="evaluation-section" wx:if="{{evaluationResult}}">
      <text class="label">è¯„ä¼°ç»“æœï¼š</text>
      <view class="evaluation-content">
        <text>{{evaluationResult}}</text>
      </view>
    </view>
  </view>

  <view class="debug-panel" wx:if="{{debugMode}}">
    <view class="debug-header">
      <text>è°ƒè¯•ä¿¡æ¯</text>
    </view>
    <view class="debug-content">
      <view class="debug-item">
        <text class="debug-label">çŠ¶æ€ï¼š</text>
        <text class="debug-value">{{debugInfo.status || 'ç©ºé—²'}}</text>
      </view>
      <view class="debug-item">
        <text class="debug-label">API Keyï¼š</text>
        <text class="debug-value">{{debugInfo.config.apiKey}}</text>
      </view>
      <view class="debug-item">
        <text class="debug-label">æ¨¡å‹ï¼š</text>
        <text class="debug-value">{{debugInfo.config.model}}</text>
      </view>
      <view class="debug-item">
        <text class="debug-label">æ–‡æœ¬é•¿åº¦ï¼š</text>
        <text class="debug-value">{{debugInfo.config.textLength || 0}}</text>
      </view>
      <view class="debug-item">
        <text class="debug-label">æ›´æ–°æ—¶é—´ï¼š</text>
        <text class="debug-value">{{debugInfo.timestamp || '-'}}</text>
      </view>
    </view>
  </view>

  <view class="setting-dialog" wx:if="{{showSettingDialog}}">
    <view class="dialog-mask"></view>
    <view class="dialog-content">
      <view class="dialog-header">
        <text>è®¾ç½®</text>
      </view>
      <form bindsubmit="onSettingSave">
        <view class="dialog-body">
          <view class="form-item">
            <text class="label">API Keyï¼š</text>
            <input name="apiKey" value="{{apiKey}}" placeholder="è¯·è¾“å…¥API Key" />
          </view>
          <view class="form-item">
            <text class="label">æ¨¡å‹ï¼š</text>
            <input name="model" value="{{model}}" placeholder="è¯·è¾“å…¥æ¨¡å‹åç§°" />
          </view>
        </view>
        <view class="dialog-footer">
          <button class="cancel-btn" bindtap="onSettingCancel">å–æ¶ˆ</button>
          <button class="save-btn" form-type="submit">ä¿å­˜</button>
        </view>
      </form>
    </view>
  </view>
</view>